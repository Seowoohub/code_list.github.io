<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Roblox ÎãâÎÑ§ÏûÑ Ïã†Ï≤≠ (ÏÑ†Ï∞©Ïàú)</title>
<style>
body {
    font-family: 'Arial', sans-serif;
    background-color: #121212;
    color: #ffffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 50px;
    min-height: 100vh;
    margin: 0;
}

.notice {
    color: #ff4b4b; /* üî¥ Îπ®Í∞Ñ Í∞ïÏ°∞ */
    font-weight: bold;
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
}

h2 {
    margin-bottom: 20px;
    color: #bb86fc; 
}

.input-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px; 
}

input[type="text"] {
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #bb86fc; 
    width: 200px;
    margin-right: 10px;
    background-color: #1e1e1e;
    color: #fff;
    transition: border-color 0.2s;
}

input[type="text"]:focus {
    outline: none;
    border-color: #6200ee;
}

button {
    padding: 10px 16px;
    font-size: 16px;
    border: none;
    border-radius: 6px;
    background-color: #bb86fc;
    color: #121212; 
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s;
}

button:hover:not(:disabled) {
    background-color: #9b5de5;
}

button:disabled {
    background-color: #555;
    cursor: not-allowed;
}

#statusMessage {
    color: #f44336; 
    font-size: 14px;
    height: 20px;
    margin-top: 5px;
    text-align: center;
}

#nameListContainer {
    margin-top: 30px;
    width: 260px;
}

#nameListContainer h3 {
    margin-bottom: 10px;
    font-weight: 500;
    color: #bbb;
    border-bottom: 1px solid #333;
    padding-bottom: 5px;
}

ul#nameList {
    list-style: none;
    padding: 0;
    margin: 0;
}

ul#nameList li {
    background-color: #1e1e1e;
    margin-bottom: 8px;
    padding: 10px;
    border-radius: 6px;
    text-align: center;
    word-break: break-all; 
}

#madeBy {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-size: 12px;
    color: #888;
}
</style>
</head>
<body>

<div class="notice">üì¢ Ïπ¥ÌÜ°Í≥µÏßÄ (ÌïÑÎèÖ)</div>
<h2>Roblox ÎãâÎÑ§ÏûÑ Ïã†Ï≤≠</h2>

<div class="input-group">
    <input id="nameInput" type="text" placeholder="ÎãâÎÑ§ÏûÑ (2~15Ïûê)" maxlength="15">
    <button id="submitBtn">Ïã†Ï≤≠</button>
</div>

<div id="statusMessage"></div>

<div id="nameListContainer">
    <h3>Ïã†Ï≤≠Ïûê Î™©Î°ù (ÏÑ†Ï∞©Ïàú)</h3>
    <ul id="nameList"></ul>
</div>

<div id="madeBy">Made by Seowoo</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyBnZzbGUop9sEOrGSjzBp2dUb-3FBCzWNk",
    authDomain: "hzbus-891e1.firebaseapp.com",
    databaseURL: "https://hzbus-891e1-default-rtdb.firebaseio.com", 
    projectId: "hzbus-891e1",
    storageBucket: "hzbus-891e1.firebasestorage.app",
    messagingSenderId: "644666053693",
    appId: "1:644666053693:web:d7727b3afa34ec72f90654",
    measurementId: "G-YF0WN2RP0T"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const applicantsRef = ref(db, "applicants"); 

const nameListEl = document.getElementById("nameList");
const nameInput = document.getElementById("nameInput");
const submitBtn = document.getElementById("submitBtn");
const statusMessageEl = document.getElementById("statusMessage");

const MIN_LENGTH = 2; 
const COOLDOWN_MS = 43200000; 

function formatRemainingTime(ms) {
    if (ms <= 0) return "0Ï¥à";
    const totalSeconds = Math.floor(ms / 1000);
    const seconds = totalSeconds % 60;
    const minutes = Math.floor((totalSeconds / 60) % 60);
    const hours = Math.floor(totalSeconds / 3600);
    let timeString = "";
    if (hours > 0) timeString += `${hours}ÏãúÍ∞Ñ `;
    if (minutes > 0) timeString += `${minutes}Î∂Ñ `;
    timeString += `${seconds}Ï¥à`;
    return timeString.trim();
}

function checkSubmissionStatus() {
    const lastSubmitTime = parseInt(localStorage.getItem("lastSubmitTime") || "0");
    const currentTime = Date.now();
    const timeElapsed = currentTime - lastSubmitTime;
    const remainingTimeMs = COOLDOWN_MS - timeElapsed;
    return { canSubmit: remainingTimeMs <= 0, remainingTimeMs: Math.max(0, remainingTimeMs) };
}

let countdownInterval = null;

function updateButtonAndMessage() {
    const { canSubmit, remainingTimeMs } = checkSubmissionStatus();
    if (canSubmit) {
        submitBtn.textContent = "Ïã†Ï≤≠";
        submitBtn.disabled = false;
        nameInput.disabled = false;
        displayStatus("");
        if (countdownInterval) {
            clearInterval(countdownInterval);
            countdownInterval = null;
        }
        return;
    }
    const remainingTimeStr = formatRemainingTime(remainingTimeMs);
    submitBtn.textContent = "Ïø®ÌÉÄÏûÑ";
    submitBtn.disabled = true;
    nameInput.disabled = true;
    displayStatus(`‚è≥ Îã§Ïùå Ïã†Ï≤≠ÍπåÏßÄ ${remainingTimeStr} ÎÇ®ÏïòÏäµÎãàÎã§.`, false, '#ffc107');
    if (!countdownInterval) countdownInterval = setInterval(updateButtonAndMessage, 1000);
}

function displayStatus(message, isSuccess = false, color = null) {
    statusMessageEl.textContent = message;
    statusMessageEl.style.color = color || (isSuccess ? '#00e676' : '#f44336');
}

async function submitName() {
    const name = nameInput.value.trim();
    if (!name) return displayStatus("ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî!");
    if (name.length < MIN_LENGTH || name.length > 15) return displayStatus(`ÎãâÎÑ§ÏûÑÏùÄ ${MIN_LENGTH}Ïûê Ïù¥ÏÉÅ, 15Ïûê Ïù¥ÌïòÏó¨Ïïº Ìï©ÎãàÎã§.`);
    if (!checkSubmissionStatus().canSubmit) return updateButtonAndMessage();

    submitBtn.textContent = "Ïã†Ï≤≠ Ï§ë...";
    submitBtn.disabled = true;
    displayStatus(""); 

    try {
        await push(applicantsRef, { name, timestamp: Date.now() });
        localStorage.setItem("lastSubmitTime", Date.now());
        nameInput.value = "";
        displayStatus("‚úÖ ÎãâÎÑ§ÏûÑ Ïã†Ï≤≠Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§! 12ÏãúÍ∞Ñ ÌõÑÏóê Îã§Ïãú Ïã†Ï≤≠ Í∞ÄÎä•Ìï©ÎãàÎã§.", true);
        updateButtonAndMessage();
    } catch (err) {
        console.error("Firebase Ïò§Î•ò:", err);
        displayStatus("üö® Ïã†Ï≤≠ Ïã§Ìå®: ÏÑúÎ≤Ñ Ïò§Î•ò ÎòêÎäî Í∂åÌïú Î¨∏Ï†ú.");
        submitBtn.textContent = "Ïã†Ï≤≠";
        submitBtn.disabled = false;
        nameInput.disabled = false;
    }
}

submitBtn.addEventListener("click", submitName);
nameInput.addEventListener("keydown", (e) => { if (e.key === "Enter" && !submitBtn.disabled) submitName(); });
document.addEventListener("DOMContentLoaded", updateButtonAndMessage);

onValue(applicantsRef, (snapshot) => {
    nameListEl.innerHTML = "";
    if (!snapshot.exists()) {
        const li = document.createElement("li");
        li.textContent = "ÏïÑÏßÅ Ïã†Ï≤≠ÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§.";
        nameListEl.appendChild(li);
        return;
    }
    const applicants = [];
    snapshot.forEach((child) => applicants.push(child.val()));
    applicants.sort((a, b) => a.timestamp - b.timestamp);
    applicants.forEach((applicant) => {
        const li = document.createElement("li");
        li.textContent = applicant.name;
        nameListEl.appendChild(li);
    });
});
</script>

</body>
</html>
