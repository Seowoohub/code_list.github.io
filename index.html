<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Roblox ë‹‰ë„¤ì„ ì‹ ì²­ (ì„ ì°©ìˆœ)</title>
<style>
/* (ê¸°ì¡´ ìŠ¤íƒ€ì¼ ì½”ë“œ ìœ ì§€) */
body {
Â  Â  font-family: 'Arial', sans-serif;
Â  Â  background-color: #121212;
Â  Â  color: #ffffff;
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  align-items: center;
Â  Â  padding: 50px;
Â  Â  min-height: 100vh;
Â  Â  margin: 0;
}

h2 {
Â  Â  margin-bottom: 5px; /* ê³µì§€ì™€ ê°„ê²©ì„ ì¢í˜ */
Â  Â  color: #bb86fc;Â 
}

/* ğŸš© ì¶”ê°€ëœ ê³µì§€ ìŠ¤íƒ€ì¼ */
.important-notice {
    color: #ffeb3b; /* ëˆˆì— ì˜ ë„ëŠ” ë…¸ë€ìƒ‰ */
    font-size: 14px;
    margin-bottom: 20px;
    padding: 5px 15px;
    border: 1px solid #ffeb3b;
    border-radius: 4px;
    font-weight: bold;
    text-align: center;
}

.input-group {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  margin-bottom: 10px;Â 
}

input[type="text"] {
Â  Â  padding: 10px;
Â  Â  font-size: 16px;
Â  Â  border-radius: 6px;
Â  Â  border: 1px solid #bb86fc;Â 
Â  Â  width: 200px;
Â  Â  margin-right: 10px;
Â  Â  background-color: #1e1e1e;
Â  Â  color: #fff;
Â  Â  transition: border-color 0.2s;
}

input[type="text"]:focus {
Â  Â  outline: none;
Â  Â  border-color: #6200ee;
}

button {
Â  Â  padding: 10px 16px;
Â  Â  font-size: 16px;
Â  Â  border: none;
Â  Â  border-radius: 6px;
Â  Â  background-color: #bb86fc;
Â  Â  color: #121212;Â 
Â  Â  font-weight: bold;
Â  Â  cursor: pointer;
Â  Â  transition: 0.2s;
}

button:hover:not(:disabled) {
Â  Â  background-color: #9b5de5;
}

button:disabled {
Â  Â  background-color: #555;
Â  Â  cursor: not-allowed;
}

#statusMessage {
Â  Â  color: #f44336;Â 
Â  Â  font-size: 14px;
Â  Â  height: 20px;
Â  Â  margin-top: 5px;
Â  Â  text-align: center;
}

#nameListContainer {
Â  Â  margin-top: 30px;
Â  Â  width: 260px;
}

#nameListContainer h3 {
Â  Â  margin-bottom: 10px;
Â  Â  font-weight: 500;
Â  Â  color: #bbb;
Â  Â  border-bottom: 1px solid #333;
Â  Â  padding-bottom: 5px;
}

ul#nameList {
Â  Â  list-style: none;
Â  Â  padding: 0;
Â  Â  margin: 0;
}

ul#nameList li {
Â  Â  background-color: #1e1e1e;
Â  Â  margin-bottom: 8px;
Â  Â  padding: 10px;
Â  Â  border-radius: 6px;
Â  Â  text-align: center;
Â  Â  word-break: break-all;Â 
}

#madeBy {
Â  Â  position: fixed;
Â  Â  bottom: 10px;
Â  Â  right: 10px;
Â  Â  font-size: 12px;
Â  Â  color: #888;
}
</style>
</head>
<body>

<h2>Roblox ë‹‰ë„¤ì„ ì‹ ì²­</h2>

<div class="important-notice">
    ğŸš¨ ì‹ ì²­ ì „ **ì¹´ì¹´ì˜¤í†¡ ê³µì§€**ë¥¼ ë°˜ë“œì‹œ ì½ì–´ì£¼ì„¸ìš”! ğŸš¨
</div>

<div class="input-group">
Â  Â  <input id="nameInput" type="text" placeholder="ë‹‰ë„¤ì„ (2~15ì)" maxlength="15">
Â  Â  <button id="submitBtn">ì‹ ì²­</button>
</div>

<div id="statusMessage"></div>

<div id="nameListContainer">
Â  Â  <h3>ì‹ ì²­ì ëª©ë¡ (ì„ ì°©ìˆœ)</h3>
Â  Â  <ul id="nameList"></ul>
</div>

<div id="madeBy">Made by Seowoo</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

// =========================================================================
// ğŸš¨ ì¤‘ìš”: Firebase ì„¤ì • (databaseURL ì¶”ê°€ë¨)
// =========================================================================
const firebaseConfig = {
Â  Â  apiKey: "AIzaSyBnZzbGUop9sEOrGSjzBp2dUb-3FBCzWNk",
Â  Â  authDomain: "hzbus-891e1.firebaseapp.com",
Â  Â  // ğŸš© Realtime Database ì‚¬ìš©ì„ ìœ„í•´ URLì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
Â  Â  databaseURL: "https://hzbus-891e1-default-rtdb.firebaseio.com",Â 
Â  Â  projectId: "hzbus-891e1",
Â  Â  storageBucket: "hzbus-891e1.firebasestorage.app",
Â  Â  messagingSenderId: "644666053693",
Â  Â  appId: "1:644666053693:web:d7727b3afa34ec72f90654",
Â  Â  measurementId: "G-YF0WN2RP0T"
};

// Firebase ì´ˆê¸°í™”
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const applicantsRef = ref(db, "applicants");Â 

// DOM ìš”ì†Œ
const nameListEl = document.getElementById("nameList");
const nameInput = document.getElementById("nameInput");
const submitBtn = document.getElementById("submitBtn");
const statusMessageEl = document.getElementById("statusMessage");

const MIN_LENGTH = 2;Â 
// 12ì‹œê°„ (12 * 60 * 60 * 1000)
const COOLDOWN_MS = 43200000;Â 

/**
Â * ë‚¨ì€ ì‹œê°„ì„ "hhì‹œê°„ mmë¶„ ssì´ˆ" í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
Â */
function formatRemainingTime(ms) {
Â  Â  if (ms <= 0) return "0ì´ˆ";
Â  Â Â 
Â  Â  const totalSeconds = Math.floor(ms / 1000);
Â  Â  const seconds = totalSeconds % 60;
Â  Â  const minutes = Math.floor((totalSeconds / 60) % 60);
Â  Â  const hours = Math.floor(totalSeconds / 3600);

Â  Â  let timeString = "";
Â  Â  if (hours > 0) timeString += `${hours}ì‹œê°„ `;
Â  Â  if (minutes > 0) timeString += `${minutes}ë¶„ `;
Â  Â  timeString += `${seconds}ì´ˆ`;
Â  Â Â 
Â  Â  return timeString.trim();
}

/**
Â * ì œì¶œ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  ë‚¨ì€ ì‹œê°„ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
Â */
function checkSubmissionStatus() {
Â  Â  // ì €ì¥ëœ ë§ˆì§€ë§‰ ì œì¶œ ì‹œê°„ (ì—†ìœ¼ë©´ 0)
Â  Â  const lastSubmitTime = parseInt(localStorage.getItem("lastSubmitTime") || "0");
Â  Â  const currentTime = Date.now();
Â  Â Â 
Â  Â  const timeElapsed = currentTime - lastSubmitTime;
Â  Â  const remainingTimeMs = COOLDOWN_MS - timeElapsed;

Â  Â  return {
Â  Â  Â  Â  canSubmit: remainingTimeMs <= 0,
Â  Â  Â  Â  remainingTimeMs: Math.max(0, remainingTimeMs)
Â  Â  };
}

let countdownInterval = null;

function updateButtonAndMessage() {
Â  Â  const { canSubmit, remainingTimeMs } = checkSubmissionStatus();

Â  Â  // ì¿¨íƒ€ì„ì´ ì§€ë‚¬ë‹¤ë©´ (ì‹ ì²­ ê°€ëŠ¥)
Â  Â  if (canSubmit) {
Â  Â  Â  Â  submitBtn.textContent = "ì‹ ì²­";
Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  nameInput.disabled = false;
Â  Â  Â  Â  displayStatus("");
Â  Â  Â  Â  if (countdownInterval) {
Â  Â  Â  Â  Â  Â  clearInterval(countdownInterval);
Â  Â  Â  Â  Â  Â  countdownInterval = null;
Â  Â  Â  Â  }
Â  Â  Â  Â  return;
Â  Â  }
Â  Â Â 
Â  Â  // ì¿¨íƒ€ì„ ì¤‘ì´ë¼ë©´ (ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘)
Â  Â  const remainingTimeStr = formatRemainingTime(remainingTimeMs);
Â  Â  submitBtn.textContent = "ì¿¨íƒ€ì„";
Â  Â  submitBtn.disabled = true;
Â  Â  nameInput.disabled = true;
Â  Â  displayStatus(`â³ ë‹¤ìŒ ì‹ ì²­ê¹Œì§€ ${remainingTimeStr} ë‚¨ì•˜ìŠµë‹ˆë‹¤.`, false, '#ffc107');
Â  Â Â 
Â  Â  // ì¹´ìš´íŠ¸ë‹¤ìš´ ì¸í„°ë²Œì´ ì—†ìœ¼ë©´ ìƒˆë¡œ ì‹œì‘ (1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸)
Â  Â  if (!countdownInterval) {
Â  Â  Â  Â  countdownInterval = setInterval(updateButtonAndMessage, 1000);
Â  Â  }
}


function displayStatus(message, isSuccess = false, color = null) {
Â  Â  statusMessageEl.textContent = message;
Â  Â  if (color) {
Â  Â  Â  Â  statusMessageEl.style.color = color;
Â  Â  } else {
Â  Â  Â  Â  statusMessageEl.style.color = isSuccess ? '#00e676' : '#f44336';
Â  Â  }
}

async function submitName() {
Â  Â  const name = nameInput.value.trim();
Â  Â Â 
Â  Â  // 1. ê¸°ë³¸ ìœ íš¨ì„± ê²€ì‚¬
Â  Â  if (!name) {
Â  Â  Â  Â  displayStatus("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”!");
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  if (name.length < MIN_LENGTH || name.length > 15) {
Â  Â  Â  Â  displayStatus(`ë‹‰ë„¤ì„ì€ ${MIN_LENGTH}ì ì´ìƒ, 15ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.`);
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  // 2. ì¿¨íƒ€ì„ ê²€ì‚¬
Â  Â  if (!checkSubmissionStatus().canSubmit) {
Â  Â  Â  Â  updateButtonAndMessage();
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  // 3. ì œì¶œ ì²˜ë¦¬
Â  Â  submitBtn.textContent = "ì‹ ì²­ ì¤‘...";
Â  Â  submitBtn.disabled = true;
Â  Â  displayStatus("");Â 

Â  Â  try {
Â  Â  Â  Â  await push(applicantsRef, {Â 
Â  Â  Â  Â  Â  Â  name: name,
Â  Â  Â  Â  Â  Â  timestamp: Date.now() // ì„ ì°©ìˆœ ì •ë ¬ì„ ìœ„í•œ íƒ€ì„ìŠ¤íƒ¬í”„
Â  Â  Â  Â  });

Â  Â  Â  Â  // ì„±ê³µ: ë§ˆì§€ë§‰ ì œì¶œ ì‹œê°„ ì—…ë°ì´íŠ¸ ë° UI ê°±ì‹ 
Â  Â  Â  Â  localStorage.setItem("lastSubmitTime", Date.now());
Â  Â  Â  Â  nameInput.value = "";
Â  Â  Â  Â  displayStatus("âœ… ë‹‰ë„¤ì„ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! 12ì‹œê°„ í›„ì— ë‹¤ì‹œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.", true);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ì¿¨íƒ€ì„ UI ì‹œì‘
Â  Â  Â  Â  updateButtonAndMessage();
Â  Â  Â  Â Â 
Â  Â  } catch (err) {
Â  Â  Â  Â  // ì‹¤íŒ¨
Â  Â  Â  Â  console.error("Firebase ì˜¤ë¥˜:", err);
Â  Â  Â  Â  displayStatus("ğŸš¨ ì‹ ì²­ ì‹¤íŒ¨: ì„œë²„ ì˜¤ë¥˜ ë˜ëŠ” ê¶Œí•œ ë¬¸ì œ.");
Â  Â  Â  Â  // ì‹¤íŒ¨í•˜ë©´ ë²„íŠ¼ í™œì„±í™”
Â  Â  Â  Â  submitBtn.textContent = "ì‹ ì²­";
Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  nameInput.disabled = false;
Â  Â  }
}

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
submitBtn.addEventListener("click", submitName);
nameInput.addEventListener("keydown", (e) => {
Â  Â  if (e.key === "Enter" && !submitBtn.disabled) submitName();
});

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì¿¨íƒ€ì„ ìƒíƒœ í™•ì¸ ë° ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
document.addEventListener("DOMContentLoaded", updateButtonAndMessage);


// ì‹¤ì‹œê°„ ì‹ ì²­ì ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ë° ì„ ì°©ìˆœ ì •ë ¬
onValue(applicantsRef, (snapshot) => {
Â  Â  nameListEl.innerHTML = "";
Â  Â  if (!snapshot.exists()) {
Â  Â  Â  Â  const li = document.createElement("li");
Â  Â  Â  Â  li.textContent = "ì•„ì§ ì‹ ì²­ìê°€ ì—†ìŠµë‹ˆë‹¤.";
Â  Â  Â  Â  nameListEl.appendChild(li);
Â  Â  Â  Â  return;
Â  Â  }
Â  Â Â 
Â  Â  const applicants = [];
Â  Â  snapshot.forEach((child) => {
Â  Â  Â  Â  applicants.push(child.val());
Â  Â  });
Â  Â Â 
Â  Â  // ğŸŸ¢ ì„ ì°©ìˆœ ì •ë ¬: íƒ€ì„ìŠ¤íƒ¬í”„ ì˜¤ë¦„ì°¨ìˆœ (ì‘ì€ ê°’ = ë¨¼ì € ì‹ ì²­)
Â  Â  applicants.sort((a, b) => a.timestamp - b.timestamp);Â 

Â  Â  applicants.forEach((applicant) => {
Â  Â  Â  Â  const li = document.createElement("li");
Â  Â  Â  Â  li.textContent = applicant.name;
Â  Â  Â  Â  nameListEl.appendChild(li);
Â  Â  });
});
</script>

</body>
</html>
